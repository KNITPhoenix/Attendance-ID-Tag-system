#include <avr/io.h>
#include <util/delay.h>
#include <string.h>
#define F_CPU 8000000UL
#include <avr/lcd4.h>
unsigned char tag1[]="";
unsigned char tag2[]="";
unsigned char tag3[]="";
unsigned char tag4[]="";
char user[];//array for the tag to be entered
unsigned char i=0;
int number=0;//number of students entered
void usartini()
{
	UCSRB|=(1<<RXEN);
	UCSRC|=(1<<URSEL)|(1<<UCSZ1)|(1<<UCSZ0);
	UBRRL=51;
}
void rx()
{
	for(i=0;i<12;i++)
	{
		while((UCSRA&(1<<RXC))==0);
		user[i]=UDR;
	}
	user[i]='\0';
	lcdstring(&user[0]);
}
void rfid_check()
{
	if(strcmp(tag1,user)==0)
	{
		lcdcmd(0x94);
		lcdstring("Match found");
		number++;
	}
	if(strcmp(tag2,user)==0)
	{
		lcdcmd(0x94);
		lcdstring("Match found");
		number++;
	}
	if(strcmp(tag3,user)==0)
	{
		lcdcmd(0x94);
		lcdstring("Match found");
		number++;
	}
	if(strcmp(tag4,user)==0)
	{
		lcdcmd(0x94);
		lcdstring("Match found");
		number++;
	}
	lcdcmd(0xd0);
	lcdstring("Students=");
	lcddata(number);
}
void main()
{
	lcdini();
	usartini();
	lcdcmd(0x80);
	lcdstring("RFID based");
	lcdcmd(0xc0);
	lcdstring("Attendance System");
	lcdcmd(0x94);
	lcdstring("Show Card");
	lcdcmd(0xd4);
	while(1)
	{
		rx();
		rfid_check();
	}
}